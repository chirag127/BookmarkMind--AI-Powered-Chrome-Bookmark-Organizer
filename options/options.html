<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BookmarkMind Settings</title>
  <link rel="stylesheet" href="options.css">
</head>

<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z"
              fill="#4285f4" />
            <path d="M7 7H17V9H7V7ZM7 11H17V13H7V11ZM7 15H14V17H7V15Z" fill="#4285f4" />
          </svg>
          <div>
            <h1>BookmarkMind</h1>
            <p>AI-Powered Bookmark Organizer</p>
          </div>
        </div>
        <div class="version">v1.0.0</div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main">
      <!-- API Configuration Section -->
      <section class="section">
        <div class="section-header">
          <h2>API Configuration</h2>
          <p>Configure your Google Gemini API key to enable AI-powered bookmark categorization.</p>
        </div>

        <div class="form-group">
          <label for="apiKey">Gemini API Key</label>
          <div class="input-group">
            <input type="password" id="apiKey" placeholder="Enter your Gemini API key (starts with AIza...)"
              autocomplete="off">
            <button type="button" id="clearApiKey" class="toggle-btn" title="Clear API Key" style="right: 40px;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                  fill="currentColor" />
              </svg>
            </button>
            <button type="button" id="toggleApiKey" class="toggle-btn" title="Show/Hide API Key">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5C17 19.5 21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17ZM12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z"
                  fill="currentColor" />
              </svg>
            </button>
          </div>
          <div class="form-help">
            <p>Get your free API key from <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI
                Studio</a></p>
            <p><strong>Tip:</strong> API keys start with "AIza" and are about 39 characters long. Use the clear button
              (✕) to enter a new key.</p>
            <div id="apiKeyStatus" class="status-indicator hidden">
              <span class="status-icon"></span>
              <span class="status-text"></span>
            </div>
          </div>
        </div>

        <!-- AgentRouter API Key (Fallback) -->
        <div class="form-group">
          <label for="agentRouterApiKey">AgentRouter API Key (Optional Fallback)</label>
          <div class="input-group">
            <input type="password" id="agentRouterApiKey"
              placeholder="Enter your AgentRouter API key (optional fallback)" autocomplete="off">
            <button type="button" id="clearAgentRouterKey" class="toggle-btn" title="Clear AgentRouter API Key"
              style="right: 40px;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                  fill="currentColor" />
              </svg>
            </button>
            <button type="button" id="toggleAgentRouterKey" class="toggle-btn" title="Show/Hide AgentRouter API Key">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5C17 19.5 21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17ZM12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z"
                  fill="currentColor" />
              </svg>
            </button>
          </div>
          <div class="form-help">
            <p>Get your free API key from <a href="https://agentrouter.org" target="_blank">AgentRouter</a>
              (provides access to multiple AI models)</p>
            <p><strong>Fallback:</strong> Used automatically when Gemini API fails (timeouts, rate limits). Supports
              free models including Gemini.</p>
            <div id="agentRouterKeyStatus" class="status-indicator hidden">
              <span class="status-icon"></span>
              <span class="status-text"></span>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" id="testApiKey" class="secondary-btn" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor" />
            </svg>
            Test API Key
          </button>
          <button type="button" id="testAgentRouterKey" class="secondary-btn" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor" />
            </svg>
            Test AgentRouter Key
          </button>
          <button type="button" id="saveApiKey" class="primary-btn" disabled>
            Save API Keys
          </button>
        </div>
      </section>

      <!-- Categories Section -->
      <section class="section">
        <div class="section-header">
          <h2>Categories</h2>
          <p>Customize the categories used to organize your bookmarks. You can add, edit, or remove categories.</p>
        </div>

        <div class="categories-container">
          <div class="categories-list" id="categoriesList">
            <!-- Categories will be populated by JavaScript -->
          </div>

          <div class="add-category">
            <div class="input-group">
              <input type="text" id="newCategoryInput" placeholder="Enter new category name (e.g., Work/Projects)"
                maxlength="50">
              <button type="button" id="addCategoryBtn" class="add-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor" />
                </svg>
                Add Category
              </button>
            </div>
            <p class="form-help">Use "/" to create nested categories (e.g., "Work/Projects/Current")</p>
          </div>
        </div>
      </section>

      <!-- Advanced Settings Section -->
      <section class="section">
        <div class="section-header">
          <h2>Advanced Settings</h2>
          <p>Configure advanced options for bookmark processing and organization.</p>
        </div>

        <div class="settings-grid">
          <div class="setting-item">
            <label for="batchSize">Batch Size</label>
            <select id="batchSize">
              <option value="25">25 bookmarks</option>
              <option value="50" selected>50 bookmarks</option>
              <option value="100">100 bookmarks</option>
            </select>
            <p class="setting-help">Number of bookmarks to process at once. Lower values are safer for large
              collections.</p>
          </div>

          <div class="setting-item">
            <div class="checkbox-group">
              <input type="checkbox" id="cleanupEmptyFolders">
              <label for="cleanupEmptyFolders">Clean up empty folders after organizing</label>
            </div>
            <p class="setting-help">Automatically remove empty bookmark folders after categorization.</p>
          </div>
        </div>
      </section>

      <!-- Statistics Section -->
      <section class="section">
        <div class="section-header">
          <h2>Statistics</h2>
          <p>Overview of your bookmark organization and extension usage.</p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalBookmarksCount">-</div>
            <div class="stat-label">Total Bookmarks</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="organizedBookmarksCount">-</div>
            <div class="stat-label">Organized</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="categoriesCount">-</div>
            <div class="stat-label">Categories</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="learningPatternsCount">-</div>
            <div class="stat-label">Learning Patterns</div>
          </div>
        </div>

        <div class="last-sort-info">
          <strong>Last Organization:</strong> <span id="lastSortDate">Never</span>
        </div>
      </section>

      <!-- Learning Data Section -->
      <section class="section">
        <div class="section-header">
          <h2>Learning Data</h2>
          <p>View and manage categorization patterns learned from your corrections.</p>
        </div>

        <div class="learning-data-container">
          <div class="learning-summary">
            <div class="summary-item">
              <span class="summary-label">Total Patterns:</span>
              <span class="summary-value" id="totalLearningPatterns">0</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Last Updated:</span>
              <span class="summary-value" id="lastLearningUpdate">Never</span>
            </div>
          </div>

          <div class="learning-patterns" id="learningPatternsList">
            <div class="no-patterns" id="noPatternsMessage">
              <p>No learning patterns collected yet. The extension will learn from your manual bookmark corrections.</p>
            </div>
          </div>

          <div class="learning-actions">
            <button type="button" id="refreshLearningData" class="secondary-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M17.65 6.35C16.2 4.9 14.21 4 12 4C7.58 4 4 7.58 4 12S7.58 20 12 20C15.73 20 18.84 17.45 19.73 14H17.65C16.83 16.33 14.61 18 12 18C8.69 18 6 15.31 6 12S8.69 6 12 6C13.66 6 15.14 6.69 16.22 7.78L13 11H20V4L17.65 6.35Z"
                  fill="currentColor" />
              </svg>
              Refresh Data
            </button>
          </div>
        </div>
      </section>

      <!-- Data Management Section -->
      <section class="section">
        <div class="section-header">
          <h2>Data Management</h2>
          <p>Manage your extension data, learning patterns, and settings.</p>
        </div>

        <div class="data-actions">
          <button type="button" id="exportData" class="secondary-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z"
                fill="currentColor" />
            </svg>
            Export Settings
          </button>

          <button type="button" id="clearLearningData" class="secondary-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 19C6 20.1 6.9 21 8 21H16C17.1 21 18 20.1 18 19V7H6V19ZM19 4H15.5L14.5 3H9.5L8.5 4H5V6H19V4Z"
                fill="currentColor" />
            </svg>
            Clear Learning Data
          </button>

          <button type="button" id="resetSettings" class="danger-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M12 5V1L7 6L12 11V7C15.31 7 18 9.69 18 13C18 16.31 15.31 19 12 19C8.69 19 6 16.31 6 13H4C4 17.42 7.58 21 12 21C16.42 21 20 17.42 20 13C20 8.58 16.42 5 12 5Z"
                fill="currentColor" />
            </svg>
            Reset All Settings
          </button>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-links">
          <a href="https://github.com/bookmarkmind/bookmarkmind" target="_blank">GitHub</a>
          <a href="https://github.com/bookmarkmind/bookmarkmind/issues" target="_blank">Report Issue</a>
          <a href="https://github.com/bookmarkmind/bookmarkmind/blob/main/README.md" target="_blank">Documentation</a>
        </div>
        <div class="footer-text">
          <p>Made with ❤️ for better bookmark organization</p>
        </div>
      </div>
    </footer>
  </div>

  <!-- Notification Toast -->
  <div id="toast" class="toast hidden">
    <div class="toast-content">
      <span class="toast-icon"></span>
      <span class="toast-message"></span>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../scripts/bookmarkService.js"></script>
  <script src="../scripts/aiProcessor.js"></script>
  <script src="../scripts/categorizer.js"></script>
  <script src="../scripts/folderManager.js"></script>
  <script src="options.js"></script>
</body>

</html>