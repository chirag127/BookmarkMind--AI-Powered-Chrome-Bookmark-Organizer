<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookmarkMind Extension Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .pass { border-color: #4caf50; background: #f1f8e9; }
        .fail { border-color: #f44336; background: #ffebee; }
        .warning { border-color: #ff9800; background: #fff3e0; }
        .test-title { font-weight: bold; margin-bottom: 10px; }
        .file-list { font-family: monospace; font-size: 12px; }
        button {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1557b0; }
    </style>
</head>
<body>
    <h1>üìö BookmarkMind Extension Test</h1>
    <p>This page helps verify that your BookmarkMind extension is properly structured and ready for installation.</p>

    <div id="tests"></div>

    <div class="test-section">
        <div class="test-title">üöÄ Installation Instructions</div>
        <ol>
            <li>Open Chrome and go to <code>chrome://extensions/</code></li>
            <li>Enable "Developer mode" (toggle in top right)</li>
            <li>Click "Load unpacked" and select this folder</li>
            <li>The BookmarkMind icon should appear in your toolbar</li>
            <li>Get a Gemini API key from <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
            <li>Configure the API key in extension settings</li>
            <li>Start organizing your bookmarks!</li>
        </ol>
    </div>

    <div class="test-section">
        <div class="test-title">üîß Quick Actions</div>
        <button onclick="window.open('chrome://extensions/', '_blank')">Open Extensions Page</button>
        <button onclick="window.open('https://makersuite.google.com/app/apikey', '_blank')">Get Gemini API Key</button>
        <button onclick="window.open('https://github.com/bookmarkmind/bookmarkmind', '_blank')">View on GitHub</button>
    </div>

    <script>
        const requiredFiles = [
            'manifest.json',
            'popup/popup.html',
            'popup/popup.css',
            'popup/popup.js',
            'options/options.html',
            'options/options.css',
            'options/options.js',
            'scripts/background.js',
            'scripts/bookmarkService.js',
            'scripts/aiProcessor.js',
            'scripts/categorizer.js',
            'scripts/folderManager.js',
            'README.md',
            'LICENSE'
        ];

        const optionalFiles = [
            'icons/icon16.png',
            'icons/icon48.png',
            'icons/icon128.png',
            'package.json',
            '.gitignore'
        ];

        async function checkFile(filename) {
            try {
                const response = await fetch(filename);
                return response.ok;
            } catch {
                return false;
            }
        }

        async function runTests() {
            const testsDiv = document.getElementById('tests');
            let allPassed = true;

            // Test required files
            const requiredResults = await Promise.all(
                requiredFiles.map(async file => ({
                    file,
                    exists: await checkFile(file)
                }))
            );

            const missingRequired = requiredResults.filter(r => !r.exists);

            if (missingRequired.length === 0) {
                testsDiv.innerHTML += `
                    <div class="test-section pass">
                        <div class="test-title">‚úÖ Required Files Check</div>
                        <p>All required files are present!</p>
                        <div class="file-list">${requiredFiles.join('<br>')}</div>
                    </div>
                `;
            } else {
                allPassed = false;
                testsDiv.innerHTML += `
                    <div class="test-section fail">
                        <div class="test-title">‚ùå Required Files Check</div>
                        <p>Missing required files:</p>
                        <div class="file-list">${missingRequired.map(r => r.file).join('<br>')}</div>
                    </div>
                `;
            }

            // Test optional files
            const optionalResults = await Promise.all(
                optionalFiles.map(async file => ({
                    file,
                    exists: await checkFile(file)
                }))
            );

            const missingOptional = optionalResults.filter(r => !r.exists);

            if (missingOptional.length === 0) {
                testsDiv.innerHTML += `
                    <div class="test-section pass">
                        <div class="test-title">‚úÖ Optional Files Check</div>
                        <p>All optional files are present!</p>
                    </div>
                `;
            } else {
                testsDiv.innerHTML += `
                    <div class="test-section warning">
                        <div class="test-title">‚ö†Ô∏è Optional Files Check</div>
                        <p>Missing optional files (extension will still work):</p>
                        <div class="file-list">${missingOptional.map(r => r.file).join('<br>')}</div>
                        <p><small>Icons can be created using create_simple_icons.html</small></p>
                    </div>
                `;
            }

            // Test manifest.json structure
            try {
                const manifestResponse = await fetch('manifest.json');
                const manifest = await manifestResponse.json();

                const requiredManifestFields = ['manifest_version', 'name', 'version', 'permissions', 'action', 'background'];
                const missingFields = requiredManifestFields.filter(field => !manifest[field]);

                if (missingFields.length === 0 && manifest.manifest_version === 3) {
                    testsDiv.innerHTML += `
                        <div class="test-section pass">
                            <div class="test-title">‚úÖ Manifest Structure</div>
                            <p>Manifest V3 structure is correct!</p>
                            <p><strong>Name:</strong> ${manifest.name}</p>
                            <p><strong>Version:</strong> ${manifest.version}</p>
                        </div>
                    `;
                } else {
                    allPassed = false;
                    testsDiv.innerHTML += `
                        <div class="test-section fail">
                            <div class="test-title">‚ùå Manifest Structure</div>
                            <p>Manifest issues found:</p>
                            <div class="file-list">${missingFields.join('<br>')}</div>
                        </div>
                    `;
                }
            } catch (error) {
                allPassed = false;
                testsDiv.innerHTML += `
                    <div class="test-section fail">
                        <div class="test-title">‚ùå Manifest Structure</div>
                        <p>Could not read or parse manifest.json</p>
                    </div>
                `;
            }

            // Overall result
            if (allPassed) {
                testsDiv.innerHTML += `
                    <div class="test-section pass">
                        <div class="test-title">üéâ Extension Ready!</div>
                        <p>BookmarkMind extension is properly structured and ready for installation!</p>
                    </div>
                `;
            } else {
                testsDiv.innerHTML += `
                    <div class="test-section fail">
                        <div class="test-title">üîß Issues Found</div>
                        <p>Please fix the issues above before installing the extension.</p>
                    </div>
                `;
            }
        }

        // Run tests when page loads
        runTests();
    </script>
</body>
</html>